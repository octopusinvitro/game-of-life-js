"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}var Location=function(){function r(t,e){_classCallCheck(this,r),this.row=t,this.cell=e}return _createClass(r,[{key:"setLocation",value:function(t,e){this.row=t,this.cell=e}},{key:"neighbours",value:function(t){var e=this._ltBorderProtected(this.cell,t),r=this._ltBorderProtected(this.row,t),n=this._rbBorderProtected(this.cell,t),i=this._rbBorderProtected(this.row,t);return[{row:r,cell:e},{row:r,cell:this.cell},{row:r,cell:n},{row:this.row,cell:e},{row:this.row,cell:n},{row:i,cell:e},{row:i,cell:this.cell},{row:i,cell:n}]}},{key:"_ltBorderProtected",value:function(t,e){return(e+t-1)%e}},{key:"_rbBorderProtected",value:function(t,e){return(e+t+1)%e}}]),r}(),Grid=function(){function i(t){_classCallCheck(this,i),this._cellCount=t,this._grid=this._createGrid(t),this._location=new Location(0,0)}return _createClass(i,[{key:"getState",value:function(t,e){return this._grid[t][e]}},{key:"setState",value:function(t,e,r){this._grid[t][e]=r}},{key:"addStarter",value:function(t){for(var e=Math.floor(this.cellCount/2-t.cellCount/2),r=0;r<t.cellCount;r++)for(var n=0;n<t.cellCount;n++)this.setState(r+e,n+e,t.getState(r,n))}},{key:"applyRules",value:function(){var t,e=new i(this._cellCount);this._copy(this,e);for(var r=0;r<this._cellCount;r++)for(var n=0;n<this._cellCount;n++)((t=this._aliveNeighboursCount(r,n))<2||3<t)&&e.setState(r,n,i.DEAD),(2===t&&this.getState(r,n)===i.ALIVE||3===t)&&e.setState(r,n,i.ALIVE);this._copy(e,this)}},{key:"_createGrid",value:function(t){return Array(t).fill().map(function(){return Array(t).fill(i.DEAD)})}},{key:"_copy",value:function(t,e){e.grid=t.grid.map(function(t){return Array.from(t)})}},{key:"_aliveNeighboursCount",value:function(t,e){var r=this;return this._location.setLocation(t,e),this._location.neighbours(this._cellCount).reduce(function(t,e){return t+r.getState(e.row,e.cell)},0)}},{key:"cellCount",get:function(){return this._cellCount}},{key:"grid",get:function(){return this._grid},set:function(t){this._grid=t}}]),i}();Grid.DEAD=0,Grid.ALIVE=1;var Starters=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"createStarter",value:function(t){var e=Math.max(Math.max.apply(Math,_toConsumableArray(t.map(function(t){return t.row}))),Math.max.apply(Math,_toConsumableArray(t.map(function(t){return t.cell})))),r=new Grid(e+1);return t.forEach(function(t){r.setState(t.row,t.cell,Grid.ALIVE)}),Object.freeze(r)}}]),t}();Starters.GLIDER=Starters.createStarter([{row:0,cell:2},{row:1,cell:0},{row:1,cell:2},{row:2,cell:1},{row:2,cell:2}]),Starters.R_PENTOMINO=Starters.createStarter([{row:0,cell:1},{row:0,cell:2},{row:1,cell:0},{row:1,cell:1},{row:2,cell:1}]),Starters.DIE_HARD=Starters.createStarter([{row:0,cell:6},{row:1,cell:0},{row:1,cell:1},{row:2,cell:1},{row:2,cell:5},{row:2,cell:6},{row:2,cell:7}]),Starters.ACORN=Starters.createStarter([{row:0,cell:1},{row:1,cell:3},{row:2,cell:0},{row:2,cell:1},{row:2,cell:4},{row:2,cell:5},{row:2,cell:6}]);var Display=function(){function r(t,e){_classCallCheck(this,r),this._screen=t.getContext("2d"),this._screenSize=t.offsetWidth,this._cellSize=t.offsetWidth/e.cellCount,t.setAttribute("style",this._canvasStyle()),this._grid=e}return _createClass(r,[{key:"addStarter",value:function(t){this._grid.addStarter(t),this._display()}},{key:"update",value:function(){this._grid.applyRules(),this._clearScreen(),this._display()}},{key:"_display",value:function(){for(var t=0;t<this._grid.cellCount;t++)for(var e=0;e<this._grid.cellCount;e++)this._setCellColor(t,e),this._screen.fillRect(e*this._cellSize,t*this._cellSize,this._cellSize,this._cellSize)}},{key:"_clearScreen",value:function(){this._screen.clearRect(0,0,this._screenSize,this._screenSize)}},{key:"_setCellColor",value:function(t,e){this._screen.fillStyle=this._grid.getState(t,e)===Grid.ALIVE?this._randomColor():r.DEFAULT_CELL_COLOR}},{key:"_randomColor",value:function(){var t=Math.floor(Math.random()*r.CELL_COLORS.length);return r.CELL_COLORS[t]}},{key:"_canvasStyle",value:function(){return"background-image:\n        linear-gradient(white 1px, transparent 1px),\n        linear-gradient(90deg, white 1px, transparent 1px),\n        linear-gradient(rgba(255,255,255,.3) 1px, transparent 1px),\n        linear-gradient(90deg, rgba(255,255,255,.3) 1px, transparent 1px);\n      background-size: ".concat(5*this._cellSize,"px ").concat(5*this._cellSize,"px,\n                       ").concat(5*this._cellSize,"px ").concat(5*this._cellSize,"px,\n                       ").concat(this._cellSize,"px ").concat(this._cellSize,"px, ").concat(this._cellSize,"px ").concat(this._cellSize,"px;\n      background-position:-1px -1px, -1px -1px, -1px -1px, -1px -1px;")}}]),r}();Display.DEFAULT_CELL_COLOR="transparent",Display.CELL_COLORS=["#fec901","#fc9a00","#ff2905","#fe5744","#ff8970","#348680","#00bd89","#33847e","#30606c","#73ceaf","#775a79","#fc87b1","#47a3e2","#a5ebe9","#3979c0"];var UserInput=function(){function n(t,e,r){_classCallCheck(this,n),this._cellCount=t,this._start=document.getElementById(e.start),this._song=document.getElementById(e.song),this._display=new Display(document.getElementById(e.canvas),new Grid(t)),this._idsToStarters=r}return _createClass(n,[{key:"initialize",value:function(){this._displayStarters(),this._initializeButtons(),this._initializeStart()}},{key:"_displayStarters",value:function(){var r=this;this._idsToStarters.forEach(function(t){var e=r._correctedCellCount(t.starter.cellCount);new Display(document.getElementById(t.id),new Grid(e)).addStarter(t.starter)})}},{key:"_initializeButtons",value:function(){var e=this;this._idsToStarters.forEach(function(t){document.getElementById("".concat(t.id,"-button")).addEventListener("click",function(){e._display.addStarter(t.starter)})})}},{key:"_initializeStart",value:function(){var e=this;this._start.addEventListener("click",function(){e._song.loop=!0,e._song.play(),function t(){e._display.update(),setTimeout(t,n.SONG_BEAT_DURATION_IN_MILLISECONDS)}()})}},{key:"_correctedCellCount",value:function(t){return t<n.MINIDISPLAY_CELL_COUNT?n.MINIDISPLAY_CELL_COUNT:t}}]),n}();UserInput.MINIDISPLAY_CELL_COUNT=8,UserInput.SONG_BEAT_DURATION_IN_MILLISECONDS=545;
//# sourceMappingURL=app.js.map
